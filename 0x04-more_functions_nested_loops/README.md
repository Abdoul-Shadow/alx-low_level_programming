 More funtions for nested loops

